<article class="game-page" itemscope itemtype="https://schema.org/VideoGame">
  <header class="game-header">
    <h1 itemprop="name">ğŸƒ Blackjack Spiel</h1>
    <div class="round-info" aria-live="polite">
      Runde: {{ gameState.roundNumber() }}
    </div>
  </header>
  <meta itemprop="description" content="Kostenloses Blackjack-Spiel zum Ãœben der Strategie">
  <meta itemprop="genre" content="Card Game">
  <meta itemprop="gamePlatform" content="Web Browser">

  <main class="game-area" role="main">
    <!-- Dealer Section -->
    <section class="dealer-section" aria-label="Dealer-Hand">
      <app-hand
        [hand]="gameState.dealerHand()"
        label="Dealer"
        [isDealer]="true"
        [showValue]="gameState.phase() !== 'player-turn'"
      />
    </section>

    <!-- Table Info -->
    @if (gameState.phase() === 'game-over') {
      <div class="result-banner" role="alert" aria-live="assertive">
        @for (result of gameState.results(); track $index) {
          <span class="result-text" [class.win]="result.outcome === 'win' || result.outcome === 'blackjack'" [class.lose]="result.outcome === 'lose'">
            {{ result.message }}
          </span>
        }
      </div>
    }

    <!-- Player Section -->
    <section class="player-section" aria-label="Spieler-Hand">
      @for (hand of gameState.playerHands(); track $index; let i = $index) {
        <app-hand
          [hand]="hand"
          [label]="gameState.playerHands().length > 1 ? 'Hand ' + (i + 1) : 'Spieler'"
          [isActive]="gameState.activeHandIndex() === i && gameState.phase() === 'player-turn'"
        />
      }
    </section>

    <!-- Actions / Betting -->
    @switch (gameState.phase()) {
      @case ('betting') {
        <app-betting-section
          [bankroll]="gameState.bankroll()"
          (betPlaced)="onBetPlaced($event)"
        />
      }
      @case ('player-turn') {
        <app-action-buttons
          [canHit]="gameState.canHit()"
          [canStand]="gameState.canStand()"
          [canDouble]="gameState.canDouble()"
          [canSplit]="gameState.canSplit()"
          (hitClicked)="onHit()"
          (standClicked)="onStand()"
          (doubleClicked)="onDouble()"
          (splitClicked)="onSplit()"
        />
      }
      @case ('game-over') {
        <div class="new-round-section">
          <button class="new-round-btn" (click)="onNewRound()">
            ğŸ° Neue Runde
          </button>
          @if (gameState.bankroll() < 10) {
            <button class="reset-btn" (click)="onResetBankroll()">
              ğŸ’° Bankroll zurÃ¼cksetzen
            </button>
          }
        </div>
      }
      @default {
        <div class="waiting-indicator">
          <span class="spinner"></span>
          Bitte warten...
        </div>
      }
    }
  </main>

  <app-message-display
    [message]="gameState.message()"
    [show]="gameState.showMessage()"
    (dismissed)="gameState.hideMessage()"
  />
</div>