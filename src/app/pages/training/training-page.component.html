<article class="training-page" itemscope itemtype="https://schema.org/WebApplication">
  <header class="training-header">
    <h1 itemprop="name" i18n="@@training.title">üìö Blackjack Strategie-Training</h1>
    <p class="subtitle" itemprop="description" i18n="@@training.subtitle">Lerne die optimale Blackjack Basic Strategy kostenlos</p>
  </header>

  <div class="training-layout">
    <!-- Sidebar -->
    <aside class="sidebar" aria-label="Trainingsstatistiken" i18n-aria-label="@@training.stats.ariaLabel">
      <app-stats-display
        [stats]="gameState.trainingStats()"
        (resetClicked)="onResetStats()"
      />

      <app-training-filter
        [filter]="gameState.trainingState().filter"
        (filterChanged)="onFilterChanged($event)"
      />
    </aside>

    <!-- Main Training Area -->
    <main class="training-area" role="main">
      @if (gameState.trainingState().currentScenario) {
        <section class="scenario-container" aria-label="Aktuelles Trainingsszenario" i18n-aria-label="@@training.scenario.ariaLabel">
          <div class="scenario-type">
            {{ getHandTypeLabel() }}
          </div>

          <!-- Dealer Card -->
          <section class="dealer-section" aria-label="Dealer-Karte" i18n-aria-label="@@training.dealerCard.ariaLabel">
            <app-hand
              [hand]="gameState.dealerHand()"
              [label]="dealerShowsLabel"
              [isDealer]="true"
            />
          </section>

          <!-- Player Hand -->
          <section class="player-section" aria-label="Deine Hand" i18n-aria-label="@@training.yourHand.ariaLabel">
            <app-hand
              [hand]="gameState.activeHand()"
              [label]="yourHandLabel"
              [isActive]="true"
            />
          </section>

          <!-- Question -->
          <div class="question-box" role="status" aria-live="polite">
            <span class="question-icon" aria-hidden="true">‚ùì</span>
            <span class="question-text" i18n="@@training.question">Was ist die optimale Aktion?</span>
          </div>

          <!-- Action Buttons -->
          <app-action-buttons
            [canHit]="!gameState.showMessage()"
            [canStand]="!gameState.showMessage()"
            [canDouble]="!gameState.showMessage()"
            [canSplit]="isPairScenario() && !gameState.showMessage()"
            (hitClicked)="onAnswer('hit')"
            (standClicked)="onAnswer('stand')"
            (doubleClicked)="onAnswer('double')"
            (splitClicked)="onAnswer('split')"
          />
        </section>
      } @else {
        <div class="no-scenario">
          <p i18n="@@training.loading">Lade Trainingsszenarien...</p>
          <button class="start-btn" (click)="startTraining()">
            <ng-container i18n="@@training.start">Training starten</ng-container>
          </button>
        </div>
      }
    </main>
  </div>

  <!-- Message Overlay -->
  @if (gameState.showMessage()) {
    <div class="feedback-overlay" (click)="onNextScenario()">
      <div 
        class="feedback-box"
        [class.correct]="gameState.trainingState().lastAnswer?.wasCorrect"
        [class.incorrect]="!gameState.trainingState().lastAnswer?.wasCorrect"
      >
        <div class="feedback-icon">
          {{ gameState.trainingState().lastAnswer?.wasCorrect ? '‚úì' : '‚úó' }}
        </div>
        <div class="feedback-text">
          {{ gameState.message() }}
        </div>
        @if (gameState.trainingState().currentScenario?.explanation) {
          <div class="feedback-explanation">
            {{ gameState.trainingState().currentScenario?.explanation }}
          </div>
        }
        <button class="next-btn" i18n="@@training.continue">
          Weiter (Klick oder Leertaste)
        </button>
      </div>
    </div>
  }
</article>